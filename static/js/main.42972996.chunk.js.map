{"version":3,"sources":["redux/root-id.const.ts","redux/initial-state.const.ts","redux/data.slice.ts","thunks/init-block.thunk.ts","blocks/constants/margin-per-level.const.ts","drag/item-types.const.ts","blocks/reorder-spacing.tsx","blocks/hooks/use-reorder-dropzone.book.ts","blocks/block-display.tsx","blocks/droppable-block.tsx","blocks/hooks/use-dropzone.hook.ts","blocks/hoc/with-drag.hoc.tsx","blocks/block-drag-handle.tsx","drag/custom-drag.hook.tsx","blocks/deletable-background.tsx","drag/drag-deletable.tsx","blocks/block.tsx","thunks/delete-block.thunk.ts","App.tsx","reportWebVitals.ts","redux/store.ts","index.tsx"],"names":["ROOT_ID","initialBlockState","blocks","isChildren","childrenOrder","findParent","dataSlice","createSlice","name","initialState","reducers","putBlock","state","action","block","payload","id","editBlock","Object","assign","removeBlock","parent","detachFromOrder","detachParent","setParent","_action$payload","child","setParentWithoutValidation","setOrder","putBeforeAndSetSibling","_action$payload2","target","before","newIndex","indexOf","_dataSlice$actions","actions","currIdx","splice","arguments","length","undefined","push","ancestor","descendant","parentLookup","curr","isAncestor","grandparent","addParent","prevParent","_state$blocks$parent$","_state$blocks","_state$blocks$parent","level","includes","initColors","initBlock","dispatch","forEach","color","generate","getBlock","marginPerLevel","ItemTypes","BLOCK","ReorderSpacing","props","_data$level","useSelector","_useReorderDropzone","useDispatch","useDrop","accept","drop","item","collect","monitor","hovered","isOver","canDrop","useReorderDropzone","_useReorderDropzone2","_slicedToArray","collectedProps","ref","backgroundColor","_jsx","style","height","display","marginLeft","BlockDisplay","React","forwardRef","opacity","borderLeft","concat","flex","DroppableBlock","_useDropzone","useDropzone","_useDropzone2","dropProps","_ref","InnerComponent","BlockDragHandle","DragIndicator","_props$style","_useDrag","useDrag","type","drag","children","initialContext","isDragging","start","current","translate","DeletableBackground","size","passedThreshold","width","position","left","top","zIndex","alignItems","justifyContent","overflow","marginRight","Delete","DELETE_DELAY","DragDeletable","_props$onDelete","onDelete","_useDragHook","_useState","useState","_useState2","dragContext","setDragContext","onMouseDown","e","context","_objectSpread","clientX","onMouseMove","onMouseUp","useDragHook","_useDragHook2","listeners","setWidth","createRef","useEffect","_ref$current","offsetWidth","handleResize","_ref$current2","window","addEventListener","removeEventListener","_useState3","_useState4","setPassedThreshold","transform","Math","min","setTimeout","_jsxs","onMouseLeave","cursor","Block","_ref$level","childMap","filter","_Fragment","Box","flexDirection","removeBlockAction","deleteBlock","border","alignSelf","map","App","rootLookup","rootIds","Container","Button","onClick","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","reducer","combineReducers","blockReducer","store","configureStore","middleware","thunk","ReactDOM","render","StrictMode","Provider","DndProvider","backend","HTML5Backend","document","getElementById"],"mappings":"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","file":"static/js/main.42972996.chunk.js","sourcesContent":["export const ROOT_ID = \"ROOT\";\n","type BlockLookup = {\n    [id: string]: Record<string, any>\n}\n\nconst initialBlockLookup: BlockLookup = {};\n\ntype ChildLookup = {\n    [id: string]: {\n        [id: string]: boolean\n    }\n}\n\nconst initialChildLookup: ChildLookup = {};\n\nexport type ChildOrder ={\n    [id: string]: string[];\n};\n\nconst initialChildOrder: ChildOrder = {};\n\nexport type ParentLookup = {\n    [id: string]: string;\n}\n\nconst initialParentLookup: ParentLookup = {};\n\nexport const initialBlockState = {\n    blocks: initialBlockLookup,\n    isChildren: initialChildLookup,\n    childrenOrder: initialChildOrder,\n    findParent: initialParentLookup,\n};\n\nexport type BlockSliceType = typeof initialBlockState;\n","import {createSlice} from \"@reduxjs/toolkit\";\nimport {BlockSliceType, initialBlockState, ParentLookup} from \"./initial-state.const\";\nimport {Block} from \"./block.entity\";\nimport {ROOT_ID} from \"./root-id.const\";\n\nconst dataSlice = createSlice({\n    name: 'data',\n    initialState: initialBlockState,\n    reducers: {\n        putBlock: (state, action) => {\n            const block: Block = action.payload;\n            state.blocks[block.id] = block;\n        },\n        editBlock: (state, action) => {\n            const block: Block = action.payload;\n            state.blocks[block.id] = Object.assign({}, state.blocks[block.id], block);\n        },\n        removeBlock: (state, action) => {\n            const id: string = action.payload;\n            delete state.blocks[id];\n            const parent = state.findParent[id];\n            if (parent){\n                detachFromOrder(state, id, parent);\n            }\n            detachParent(state, id);\n        },\n        setParent: (state, action) => {\n            const {child, parent} = action.payload;\n            if (child === parent) {\n                return;\n            }\n            if (child === ROOT_ID) {\n                return;\n            }\n            setParentWithoutValidation(state, child, parent);\n            detachFromOrder(state, child, parent);\n            setOrder(state, parent, child);\n        },\n        putBeforeAndSetSibling: (state, action) => {\n            const {target, before} = action.payload;\n            if (before === ROOT_ID) {\n                return;\n            }\n            if (target === before) {\n                return;\n            }\n            const parent = state.findParent[before];\n            setParentWithoutValidation(state, target, parent);\n            detachFromOrder(state, target, parent);\n            const newIndex = state.childrenOrder[parent].indexOf(before);\n            setOrder(state, parent, target, newIndex);\n        }\n    }\n});\n\nexport default dataSlice.reducer;\nexport const {putBlock, editBlock, removeBlock, setParent, putBeforeAndSetSibling} = dataSlice.actions;\n\nfunction detachFromOrder(state: BlockSliceType, child: string, parent: string) {\n    const currIdx = state.childrenOrder[parent].indexOf(child);\n    if (currIdx !== -1) {\n        state.childrenOrder[parent].splice(currIdx, 1);\n    }\n}\n\nfunction setOrder(state: BlockSliceType, parent: string, child: string, newIndex: number = -1) {\n    if (newIndex === -1) {\n        state.childrenOrder[parent].push(child);\n    } else {\n        state.childrenOrder[parent].splice(newIndex, 0, child);\n    }\n}\n\nfunction setParentWithoutValidation(state: BlockSliceType, child: string, parent: string) {\n    if (isAncestor(child, parent, state.findParent)) {\n        // If intended child was a parent of intended parent\n        const ancestor = child;\n        const descendant = parent;\n        const grandparent = state.findParent[ancestor];\n        detachParent(state, descendant);\n        addParent(state, descendant, grandparent);\n        detachParent(state, ancestor);\n        addParent(state, ancestor, descendant);\n    } else {\n        detachParent(state, child);\n        addParent(state, child, parent);\n    }\n}\n\nfunction isAncestor(ancestor: string, descendant: string, parentLookup: ParentLookup) {\n    let curr: string = descendant;\n    while (curr !== ROOT_ID) {\n        if (curr === ancestor) {\n            return true;\n        }\n        curr = parentLookup[curr];\n    }\n    return false;\n}\n\n// children order is retained\nfunction detachParent(state: BlockSliceType, child: string) {\n    const prevParent = state.findParent[child];\n    if (prevParent) {\n        state.isChildren[prevParent][child] = false;\n    }\n    delete state.findParent[child];\n}\n\nfunction addParent(state: BlockSliceType, child: string, parent: string) {\n    if (!state.isChildren[parent]) {\n        state.isChildren[parent] = {};\n    }\n    if (!state.childrenOrder[parent]) {\n        state.childrenOrder[parent] = [];\n    }\n    state.isChildren[parent][child] = true;\n    state.findParent[child] = parent;\n    state.blocks[child].level = (state.blocks?.[parent]?.level ?? -1) + 1; //TODO\n    if (!state.childrenOrder[parent].includes(child)) {\n        state.childrenOrder[parent].push(child);\n    }\n}","import { Dispatch } from \"@reduxjs/toolkit\";\nimport {generate} from \"short-uuid\";\nimport {putBlock, setParent} from \"../redux/data.slice\";\nimport {ROOT_ID} from \"../redux/root-id.const\";\n\nconst initColors = ['red', 'blue', 'grey', 'green', 'yellow', 'black'];\n\nexport function initBlock(){\n    return function (dispatch: Dispatch){\n        const getBlock = (color: string) => ({\n            id: generate(),\n            color\n        });\n        initColors.forEach(color => {\n            const block = getBlock(color);\n            dispatch(putBlock(block));\n            dispatch(setParent({child: block.id, parent: ROOT_ID}));\n        });\n    }\n}","export const marginPerLevel = 10;\n","export const ItemTypes = {\n  BLOCK: 'BLOCK'\n};\n","import React from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {RootState} from \"../redux/store\";\nimport {marginPerLevel} from \"./constants/margin-per-level.const\";\nimport {BlockData} from \"./interfaces/block-data.interface\";\nimport {useReorderDropzone} from \"./hooks/use-reorder-dropzone.book\";\n\nexport function ReorderSpacing(props: BlockData) {\n    const {id} = props;\n    const data = useSelector((state: RootState) => state.block.blocks[id]) || {};\n    const {level = 0} = data;\n    const [collectedProps, ref] = useReorderDropzone(id);\n    const {hovered, canDrop} = collectedProps;\n    let backgroundColor = 'transparent';\n    if (hovered && canDrop) {\n        backgroundColor = 'blue';\n    }\n    return (\n        <div ref={ref} style={{\n            height: 10,\n            display: \"flex\",\n            // border: `1px solid ${data.color}`,\n            backgroundColor: backgroundColor,\n            marginLeft: marginPerLevel * level,\n        }}/>\n    )\n}\n","import {useDispatch} from \"react-redux\";\nimport {useDrop} from \"react-dnd\";\nimport {ItemTypes} from \"../../drag/item-types.const\";\nimport {BlockTransfer} from \"../../drag/block-transfer.type\";\nimport {putBeforeAndSetSibling} from \"../../redux/data.slice\";\n\nexport function useReorderDropzone(id: string) {\n    const dispatch = useDispatch();\n    return useDrop(() => ({\n        accept: ItemTypes.BLOCK,\n        drop: (item: BlockTransfer) => {\n            dispatch(putBeforeAndSetSibling({target: item.id, before: id}));\n        },\n        collect: (monitor) => ({\n            hovered: monitor.isOver(),\n            canDrop: monitor.canDrop(),\n        }),\n        canDrop: (item) => item.id !== id,\n    }));\n}\n","import {useSelector} from \"react-redux\";\nimport {RootState} from \"../redux/store\";\nimport React, {ForwardedRef} from \"react\";\nimport {Hoverable} from \"./interfaces/hoverable.interface\";\nimport {BlockData} from \"./interfaces/block-data.interface\";\n\ninterface Props extends Hoverable, BlockData {\n}\n\nexport const BlockDisplay = React.forwardRef((props: Props, ref: ForwardedRef<HTMLDivElement>) => {\n    const {id, hovered, canDrop} = props;\n    const data = useSelector((state: RootState) => state.block.blocks[id]) || {};\n    const {color} = data;\n\n    const opacity = hovered && canDrop ? 0.5 : 1;\n\n    return (\n        <div ref={ref} style={{\n            borderLeft: `1px solid ${color}`,\n            backgroundColor: 'white',\n            height: 100,\n            flex: 1,\n            opacity\n        }}/>\n    )\n})","import React from \"react\";\nimport {BlockDisplay} from \"./block-display\";\nimport {useDropzone} from \"./hooks/use-dropzone.hook\";\nimport { BlockData } from \"./interfaces/block-data.interface\";\n\nexport function DroppableBlock(props: BlockData) {\n    const {id} = props;\n    const [dropProps, drop] = useDropzone(id);\n    const {hovered, canDrop} = dropProps || {};\n    return (\n        <BlockDisplay ref={drop} id={id} hovered={hovered} canDrop={canDrop}/>\n    )\n}","import {useDispatch} from \"react-redux\";\nimport {useDrop} from \"react-dnd\";\nimport {ItemTypes} from \"../../drag/item-types.const\";\nimport {BlockTransfer} from \"../../drag/block-transfer.type\";\nimport {setParent} from \"../../redux/data.slice\";\n\nexport function useDropzone(id: string) {\n    const dispatch = useDispatch();\n    return useDrop(() => ({\n        accept: ItemTypes.BLOCK,\n        drop: (item: BlockTransfer) => {\n            dispatch(setParent({child: item.id, parent: id}))\n        },\n        collect: (monitor) => ({\n            hovered: monitor.isOver(),\n            canDrop: monitor.canDrop(),\n        }),\n        canDrop: (item) => item.id !== id,\n    }));\n}\n","import React from \"react\";\nimport {useDrag} from \"react-dnd\";\nimport {BlockData} from \"../interfaces/block-data.interface\";\nimport {ItemTypes} from \"../../drag/item-types.const\";\n\ninterface Style {\n    style?: Record<string, any>\n}\n\nexport function withDrag() {\n    return function (InnerComponent: React.ComponentType) {\n        return function (props: BlockData & Style) {\n            const {id} = props;\n            const [, drag] = useDrag(() => ({\n                type: ItemTypes.BLOCK,\n                item: {id},\n            }));\n            return (\n                <div ref={drag} style={props.style ?? {}}>\n                    <InnerComponent/>\n                </div>\n            )\n        }\n    }\n}\n","import {withDrag} from \"./hoc/with-drag.hoc\";\nimport {DragIndicator} from \"@material-ui/icons\";\n\nexport const BlockDragHandle = withDrag()(DragIndicator);\n","import {useState} from \"react\";\n\ntype DragContext = {\n    isDragging: boolean;\n    start: number | undefined;\n    current: number | undefined;\n    translate: number;\n}\n\ntype Listeners = {\n    onMouseDown: (e: any) => void,\n    onMouseMove: (e: any) => void,\n    onMouseUp: (e: any) => void\n};\n\nconst initialContext: DragContext = {\n    isDragging: false,\n    start: undefined,\n    current: undefined,\n    translate: 0,\n};\n\nexport function useDragHook(): [Listeners, DragContext] {\n    const [dragContext, setDragContext] = useState<DragContext>(initialContext)\n    const onMouseDown = (e: any) => {\n        setDragContext(context => ({\n            ...context,\n            isDragging: true,\n            start: e.clientX\n        }))\n    };\n    const onMouseMove = (e: any) => {\n        setDragContext(context => ({\n            ...context,\n            current: context.isDragging ? e.clientX : undefined,\n            translate: context.start && context.current ? context.current - context.start : 0\n        }))\n    };\n    const onMouseUp = (e: any) => {\n        setDragContext(initialContext)\n    }\n    const listeners: Listeners = {onMouseDown, onMouseMove, onMouseUp};\n    return [listeners, dragContext];\n}","import React from \"react\";\nimport {Delete} from \"@material-ui/icons\";\n\ntype Props = {\n    passedThreshold: boolean;\n}\n\nexport function DeletableBackground(props: Props) {\n    const {passedThreshold} = props;\n    const maxed = '2em'\n    const size = passedThreshold ? maxed : '1em';\n    return (\n        <div style={{\n            backgroundColor: 'red',\n            height: '100%',\n            width: '100%',\n            position: 'absolute',\n            left: 0,\n            top: 0,\n            zIndex: -1,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'flex-end',\n            overflow: 'hidden'\n        }}\n        >\n            <div style={{marginRight: maxed}}>\n                <Delete style={{height: size, width: size, color: 'white', zIndex: 0}}/>\n            </div>\n        </div>\n    )\n}\n","import React, {createRef, useEffect, useState} from \"react\";\nimport {useDragHook} from \"./custom-drag.hook\";\nimport {DeletableBackground} from \"../blocks/deletable-background\";\n\ntype Props = {\n    children: React.ReactNode;\n    style?: Record<string, any>;\n    onDelete?: () => void;\n}\n\nconst DELETE_DELAY = 100;\n\nexport function DragDeletable(props: Props) {\n    const {\n        style = {}, onDelete = () => {\n        }\n    } = props;\n    const [listeners, dragContext] = useDragHook();\n    const {onMouseDown, onMouseUp, onMouseMove} = listeners;\n    const {translate, isDragging} = dragContext;\n\n    const [width, setWidth] = useState<number | undefined>();\n    const ref = createRef<HTMLDivElement>();\n\n    useEffect(() => {\n        setWidth(ref.current?.offsetWidth);\n        const handleResize = (e: Event) => {\n            setWidth(ref.current?.offsetWidth);\n        }\n        window.addEventListener('resize', handleResize);\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        }\n    }, [ref])\n\n    const [passedThreshold, setPassedThreshold] = useState(false);\n    useEffect(() => {\n        if (isDragging) {\n            if (translate && width) {\n                setPassedThreshold(-translate / width > 0.25);\n            }\n        }\n    }, [translate, width, isDragging])\n\n    const transform = passedThreshold && !isDragging ? 'translateX(-1000%)' : `translateX(${Math.min(translate, 0)}px)`;\n\n    useEffect(() => {\n        if (passedThreshold && !isDragging) {\n            setTimeout(() => onDelete(), DELETE_DELAY);\n        }\n    }, [passedThreshold, isDragging, onDelete])\n\n    return (\n        <div ref={ref}\n             onMouseDown={onMouseDown}\n             onMouseMove={onMouseMove}\n             onMouseUp={onMouseUp}\n             onMouseLeave={onMouseUp}\n             style={{position: 'relative', ...style}}>\n            <div style={{transform, cursor: 'move'}}>\n                {props.children}\n            </div>\n            <DeletableBackground passedThreshold={passedThreshold}/>\n        </div>\n    )\n}","import React from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Box} from \"@material-ui/core\";\nimport {RootState} from \"../redux/store\";\nimport {ReorderSpacing} from \"./reorder-spacing\";\nimport {DroppableBlock} from \"./droppable-block\";\nimport {BlockDragHandle} from \"./block-drag-handle\";\nimport {BlockData} from './interfaces/block-data.interface';\nimport {DragDeletable} from \"../drag/drag-deletable\";\nimport {marginPerLevel} from \"./constants/margin-per-level.const\";\nimport {deleteBlock} from \"../thunks/delete-block.thunk\";\n\nexport function Block(props: BlockData) {\n    const {id} = props;\n    const dispatch = useDispatch();\n    const {color, level = 0} = useSelector((state: RootState) => state.block.blocks[id]) || {};\n    const childMap = useSelector((state: RootState) => state.block.isChildren[id]) || {};\n    const childOrder = useSelector((state: RootState) => state.block.childrenOrder[id] || []);\n    const children = childOrder.filter(id => childMap[id]);\n\n    const marginLeft = level * marginPerLevel;\n\n    return (\n        <>\n            <Box flexDirection={'column'} display={'flex'} flex={1} alignItems={'stretch'}>\n                <ReorderSpacing id={id}/>\n                <DragDeletable style={{marginLeft}} onDelete={() => dispatch(deleteBlock(id))}>\n                    <Box flexDirection={'row'} display={'flex'} alignItems={'center'} position={'relative'}\n                         style={{border: `1px solid ${color}`}}>\n                        <BlockDragHandle id={id} style={{\n                            backgroundColor: 'white',\n                            alignSelf: 'stretch',\n                            alignItems: 'center',\n                            display: 'flex',\n                        }}/>\n                        <DroppableBlock id={id}/>\n                    </Box>\n                </DragDeletable>\n            </Box>\n            {children.map((id) => <Block key={id} id={id}/>)}\n        </>\n    )\n}","import {Dispatch} from \"@reduxjs/toolkit\";\nimport {removeBlock as removeBlockAction} from '../redux/data.slice';\n\nexport function deleteBlock(id: string) {\n    return function (dispatch: Dispatch) {\n        dispatch(removeBlockAction(id));\n    }\n}","import React from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {Button, Container} from \"@material-ui/core\";\nimport {RootState} from \"./redux/store\";\nimport {ROOT_ID} from \"./redux/root-id.const\";\nimport './App.css';\nimport {initBlock} from \"./thunks/init-block.thunk\";\nimport { Block } from \"./blocks/block\";\n\nfunction App() {\n  const rootLookup = useSelector((state: RootState) => state.block.isChildren[ROOT_ID]) || {};\n  const rootOrder = useSelector((state: RootState) => state.block.childrenOrder[ROOT_ID]) || [];\n  const rootIds = rootOrder.filter(id => rootLookup[id]);\n  const dispatch = useDispatch();\n\n  return (\n    <Container>\n      <Button onClick={() => {dispatch(initBlock())}}>initBlocks</Button>\n      {rootIds.map(id => <Block key={id} id={id}/>)}\n    </Container>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import blockReducer from \"./data.slice\";\nimport {combineReducers, configureStore} from \"@reduxjs/toolkit\";\nimport thunk from \"redux-thunk\";\n\nconst reducer = combineReducers({block: blockReducer});\nexport const store = configureStore({\n    reducer: reducer,\n    middleware: [thunk]\n});\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppDispatch = typeof store.dispatch;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { Provider } from 'react-redux';\nimport {store} from \"./redux/store\";\nimport { DndProvider } from 'react-dnd'\nimport { HTML5Backend } from 'react-dnd-html5-backend'\n// import { TouchBackend } from 'react-dnd-touch-backend';\n\nReactDOM.render(\n  <React.StrictMode>\n  <Provider store={store}>\n    {/*<DndProvider backend={TouchBackend}>*/}\n    <DndProvider backend={HTML5Backend}>\n      <App />\n    </DndProvider>\n  </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your data, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}